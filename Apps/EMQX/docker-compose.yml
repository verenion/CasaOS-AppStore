name: emqx
services:
  emqx:
    image: emqx:5.8.5
    restart: unless-stopped
    container_name: emqx1
    environment:
    - "EMQX_NODE_NAME=emqx@node1.emqx.io"
    - "EMQX_CLUSTER__DISCOVERY_STRATEGY=static"
    - "EMQX_CLUSTER__STATIC__SEEDS=[emqx@node1.emqx.io]"
    healthcheck:
      test: ["CMD", "/opt/emqx/bin/emqx", "ctl", "status"]
      interval: 5s
      timeout: 25s
      retries: 5
    networks:
      emqx-bridge:
        aliases:
        - node1.emqx.io
    ports:
      - target: 1883
        published: 1883
        protocol: tcp
      - target: 8083
        published: 8083
        protocol: tcp
      - target: 8084
        published: 8084
        protocol: tcp
      - target: 8883
        published: 8883
        protocol: tcp
      - target: 18083
        published: 18083
        protocol: tcp
    x-casaos:
      volumes:
        - container: /opt/emqx/data
          description:
            en_us: Contains emqx data.
        - container: /opt/emqx/logs
          description:
            en_us: Contains emqx logs.
      ports:
        - container: '1883'
          description:
            en_us: MQTT Port
        - container: '8083'
          description:
            en_us: EMQX Port 1
        - container: '8084'
          description:
            en_us: EMQX Port 2
        - container: '8883'
          description:
            en_us: EMQX Port 3
        - container: '18083'
          description:
            en_us: EMQX Port 4
    volumes:
      - type: bind
        source: /DATA/AppData/$AppID/data
        target: /opt/emqx/data
      - type: bind
        source: /DATA/AppData/$AppID/logs
        target: /opt/emqx/logs  
x-casaos:
  architectures:
    - amd64
    - arm
    - arm64
  main: emqx
  tagline:
    en_us: EMQX Broker.
  description:
    en_us: EMQX Broker!
  developer: verenion
  author: verenion
  icon: https://cdn.jsdelivr.net/gh/IceWhaleTech/CasaOS-AppStore@main/Apps/WireGuardEasy/icon.png
  thumbnail: https://cdn.jsdelivr.net/gh/IceWhaleTech/CasaOS-AppStore@main/Apps/WireGuardEasy/icon.png
  category: Network
  tips:
    before_install:
      en_us: |
        ğŸ”§ Settings

        Default password: `casaos`

        âš ï¸ Warning!

        You need to change at least change the mandatory parameter `WG_HOST` for this app to work properly.
        It's value has to be a domain (or an IP address) that points to this server (accesible from WAN).

        Same applies to the `WG_PORT` parameter. Change it to the port accessible from outside your LAN if it differs from the default 51820.
      zh_cn: |
        ğŸ”§ è®¾ç½®

        é»˜è®¤å¯†ç ï¼š `casaos`

        âš ï¸ è­¦å‘Šï¼

        æ‚¨è‡³å°‘éœ€è¦æ›´æ”¹å¼ºåˆ¶å‚æ•° `WG_HOST` æ‰èƒ½ä½¿æœ¬åº”ç”¨ç¨‹åºæ­£å¸¸å·¥ä½œã€‚
        å…¶å€¼å¿…é¡»æ˜¯æŒ‡å‘æœ¬æœåŠ¡å™¨çš„åŸŸï¼ˆæˆ– IP åœ°å€ï¼‰ï¼ˆå¯ä»å¹¿åŸŸç½‘è®¿é—®ï¼‰ã€‚

        åŒæ ·ï¼Œ`WG_PORT` å‚æ•°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœä¸é»˜è®¤çš„ 51820 ä¸åŒï¼Œè¯·å°†å…¶æ›´æ”¹ä¸ºå±€åŸŸç½‘å¤–å¯ä»¥è®¿é—®çš„ç«¯å£ã€‚
  title:
    en_us: EMQX
  port_map: '18083'
